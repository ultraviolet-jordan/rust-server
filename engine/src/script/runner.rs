use cache::{CacheProvider, ScriptOpcode, ScriptState};

use crate::script::ops::core_ops::script_core_ops;
use crate::script::ops::math_ops::script_math_ops;
use crate::script::ops::string_ops::script_string_ops;

pub fn script_runner<'script>(
    code: &ScriptOpcode,
    state: &mut ScriptState<'script>,
    provider: &'script CacheProvider,
) {
    // println!("{:?}", code);
    match code {
        // Core language ops (0-99)
        ScriptOpcode::PushConstantInt => script_core_ops(code, state, provider),
        ScriptOpcode::PushVarp => script_core_ops(code, state, provider),
        ScriptOpcode::PopVarp => script_core_ops(code, state, provider),
        ScriptOpcode::PushConstantString => script_core_ops(code, state, provider),
        ScriptOpcode::PushVarn => script_core_ops(code, state, provider),
        ScriptOpcode::PopVarn => script_core_ops(code, state, provider),
        ScriptOpcode::Branch => script_core_ops(code, state, provider),
        ScriptOpcode::BranchNot => script_core_ops(code, state, provider),
        ScriptOpcode::BranchEquals => script_core_ops(code, state, provider),
        ScriptOpcode::BranchLessThan => script_core_ops(code, state, provider),
        ScriptOpcode::BranchGreaterThan => script_core_ops(code, state, provider),
        ScriptOpcode::PushVars => script_core_ops(code, state, provider),
        ScriptOpcode::PopVars => script_core_ops(code, state, provider),
        ScriptOpcode::Return => script_core_ops(code, state, provider),
        ScriptOpcode::GoSub => script_core_ops(code, state, provider),
        ScriptOpcode::Jump => script_core_ops(code, state, provider),
        ScriptOpcode::Switch => script_core_ops(code, state, provider),
        ScriptOpcode::PushVarbit => script_core_ops(code, state, provider),
        ScriptOpcode::PopVarbit => script_core_ops(code, state, provider),
        ScriptOpcode::BranchLessThanOrEquals => script_core_ops(code, state, provider),
        ScriptOpcode::BranchGreaterThanOrEquals => script_core_ops(code, state, provider),
        ScriptOpcode::PushIntLocal => script_core_ops(code, state, provider),
        ScriptOpcode::PopIntLocal => script_core_ops(code, state, provider),
        ScriptOpcode::PushStringLocal => script_core_ops(code, state, provider),
        ScriptOpcode::PopStringLocal => script_core_ops(code, state, provider),
        ScriptOpcode::JoinString => script_core_ops(code, state, provider),
        ScriptOpcode::PopIntDiscard => script_core_ops(code, state, provider),
        ScriptOpcode::PopStringDiscard => script_core_ops(code, state, provider),
        ScriptOpcode::GoSubWithParams => script_core_ops(code, state, provider),
        ScriptOpcode::JumpWithParams => script_core_ops(code, state, provider),
        ScriptOpcode::PushVarcInt => script_core_ops(code, state, provider),
        ScriptOpcode::PopVarcInt => script_core_ops(code, state, provider),
        ScriptOpcode::DefineArray => script_core_ops(code, state, provider),
        ScriptOpcode::PushArrayInt => script_core_ops(code, state, provider),
        ScriptOpcode::PopArrayInt => script_core_ops(code, state, provider),
        ScriptOpcode::EndCoreOps => script_core_ops(code, state, provider),
        // Server ops (1000-1999)
        ScriptOpcode::CoordX => panic!("Not implemented"),
        ScriptOpcode::CoordY => panic!("Not implemented"),
        ScriptOpcode::CoordZ => panic!("Not implemented"),
        ScriptOpcode::Distance => panic!("Not implemented"),
        ScriptOpcode::HuntAll => panic!("Not implemented"),
        ScriptOpcode::HuntNext => panic!("Not implemented"),
        ScriptOpcode::InZone => panic!("Not implemented"),
        ScriptOpcode::LineOfSight => panic!("Not implemented"),
        ScriptOpcode::LineOfWalk => panic!("Not implemented"),
        ScriptOpcode::MapBlocked => panic!("Not implemented"),
        ScriptOpcode::MapIndoors => panic!("Not implemented"),
        ScriptOpcode::MapClock => panic!("Not implemented"),
        ScriptOpcode::MapLocAddUnsafe => panic!("Not implemented"),
        ScriptOpcode::MapMembers => panic!("Not implemented"),
        ScriptOpcode::MapPlayerCount => panic!("Not implemented"),
        ScriptOpcode::MapFindSquare => panic!("Not implemented"),
        ScriptOpcode::MoveCoord => panic!("Not implemented"),
        ScriptOpcode::PlayerCount => panic!("Not implemented"),
        ScriptOpcode::ProjAnimMap => panic!("Not implemented"),
        ScriptOpcode::ProjAnimNpc => panic!("Not implemented"),
        ScriptOpcode::ProjAnimPl => panic!("Not implemented"),
        ScriptOpcode::SeqLength => panic!("Not implemented"),
        ScriptOpcode::SplitGet => panic!("Not implemented"),
        ScriptOpcode::SplitGetAnim => panic!("Not implemented"),
        ScriptOpcode::SplitInit => panic!("Not implemented"),
        ScriptOpcode::SplitLineCount => panic!("Not implemented"),
        ScriptOpcode::SplitPageCount => panic!("Not implemented"),
        ScriptOpcode::SpotAnimMap => panic!("Not implemented"),
        ScriptOpcode::StatRandom => panic!("Not implemented"),
        ScriptOpcode::StructParam => panic!("Not implemented"),
        ScriptOpcode::WorldDelay => panic!("Not implemented"),
        ScriptOpcode::NpcsCount => panic!("Not implemented"),
        ScriptOpcode::ZonesCount => panic!("Not implemented"),
        ScriptOpcode::LocsCount => panic!("Not implemented"),
        ScriptOpcode::ObjsCount => panic!("Not implemented"),
        ScriptOpcode::MapMulti => panic!("Not implemented"),
        // Player ops (2000-2499)
        ScriptOpcode::AllowDesign => panic!("Not implemented"),
        ScriptOpcode::Anim => panic!("Not implemented"),
        ScriptOpcode::BasReadyAnim => panic!("Not implemented"),
        ScriptOpcode::BasRunning => panic!("Not implemented"),
        ScriptOpcode::BasTurnOnSpot => panic!("Not implemented"),
        ScriptOpcode::BasWalkB => panic!("Not implemented"),
        ScriptOpcode::BasWalkF => panic!("Not implemented"),
        ScriptOpcode::BasWalkL => panic!("Not implemented"),
        ScriptOpcode::BasWalkR => panic!("Not implemented"),
        ScriptOpcode::BufferFull => panic!("Not implemented"),
        ScriptOpcode::BuildAppearance => panic!("Not implemented"),
        ScriptOpcode::Busy => panic!("Not implemented"),
        ScriptOpcode::CamLookAt => panic!("Not implemented"),
        ScriptOpcode::CamMoveTo => panic!("Not implemented"),
        ScriptOpcode::CamReset => panic!("Not implemented"),
        ScriptOpcode::CamShake => panic!("Not implemented"),
        ScriptOpcode::ClearQueue => panic!("Not implemented"),
        ScriptOpcode::ClearSoftTimer => panic!("Not implemented"),
        ScriptOpcode::ClearTimer => panic!("Not implemented"),
        ScriptOpcode::GetTimer => panic!("Not implemented"),
        ScriptOpcode::Coord => panic!("Not implemented"),
        ScriptOpcode::Damage => panic!("Not implemented"),
        ScriptOpcode::Displayname => panic!("Not implemented"),
        ScriptOpcode::FaceSquare => panic!("Not implemented"),
        ScriptOpcode::FindUid => panic!("Not implemented"),
        ScriptOpcode::Gender => panic!("Not implemented"),
        ScriptOpcode::GetQueue => panic!("Not implemented"),
        ScriptOpcode::StatAdvance => panic!("Not implemented"),
        ScriptOpcode::HeadiconsGet => panic!("Not implemented"),
        ScriptOpcode::HeadiconsSet => panic!("Not implemented"),
        ScriptOpcode::HealEnergy => panic!("Not implemented"),
        ScriptOpcode::HintCoord => panic!("Not implemented"),
        ScriptOpcode::HintNpc => panic!("Not implemented"),
        ScriptOpcode::HintPlayer => panic!("Not implemented"),
        ScriptOpcode::HintStop => panic!("Not implemented"),
        ScriptOpcode::IfClose => panic!("Not implemented"),
        ScriptOpcode::TutClose => panic!("Not implemented"),
        ScriptOpcode::IfMultiZone => panic!("Not implemented"),
        ScriptOpcode::IfOpenChat => panic!("Not implemented"),
        ScriptOpcode::TutOpen => panic!("Not implemented"),
        ScriptOpcode::IfOpenMain => panic!("Not implemented"),
        ScriptOpcode::IfOpenMainSide => panic!("Not implemented"),
        ScriptOpcode::IfOpenSide => panic!("Not implemented"),
        ScriptOpcode::IfSetAnim => panic!("Not implemented"),
        ScriptOpcode::IfSetColour => panic!("Not implemented"),
        ScriptOpcode::IfSetHide => panic!("Not implemented"),
        ScriptOpcode::IfSetModel => panic!("Not implemented"),
        ScriptOpcode::IfSetRecol => panic!("Not implemented"),
        ScriptOpcode::IfSetNpcHead => panic!("Not implemented"),
        ScriptOpcode::IfSetObject => panic!("Not implemented"),
        ScriptOpcode::IfSetPlayerHead => panic!("Not implemented"),
        ScriptOpcode::IfSetPosition => panic!("Not implemented"),
        ScriptOpcode::IfSetResumeButtons => panic!("Not implemented"),
        ScriptOpcode::IfSetTab => panic!("Not implemented"),
        ScriptOpcode::IfSetTabActive => panic!("Not implemented"),
        ScriptOpcode::TutFlash => panic!("Not implemented"),
        ScriptOpcode::IfSetText => panic!("Not implemented"),
        ScriptOpcode::LastLoginInfo => panic!("Not implemented"),
        ScriptOpcode::LastCom => panic!("Not implemented"),
        ScriptOpcode::LastInt => panic!("Not implemented"),
        ScriptOpcode::LastItem => panic!("Not implemented"),
        ScriptOpcode::LastSlot => panic!("Not implemented"),
        ScriptOpcode::LastTargetSlot => panic!("Not implemented"),
        ScriptOpcode::LastUseItem => panic!("Not implemented"),
        ScriptOpcode::LastUseSlot => panic!("Not implemented"),
        ScriptOpcode::LongQueue => panic!("Not implemented"),
        ScriptOpcode::Mes => {
            println!("{}", state.pop_string());
        }
        ScriptOpcode::MidiJingle => panic!("Not implemented"),
        ScriptOpcode::MidiSong => panic!("Not implemented"),
        ScriptOpcode::Name => panic!("Not implemented"),
        ScriptOpcode::PApRange => panic!("Not implemented"),
        ScriptOpcode::PArriveDelay => panic!("Not implemented"),
        ScriptOpcode::PCountDialog => panic!("Not implemented"),
        ScriptOpcode::PDelay => panic!("Not implemented"),
        ScriptOpcode::PExactMove => panic!("Not implemented"),
        ScriptOpcode::PFindUid => panic!("Not implemented"),
        ScriptOpcode::PLocMerge => panic!("Not implemented"),
        ScriptOpcode::PLogout => panic!("Not implemented"),
        ScriptOpcode::POpHeld => panic!("Not implemented"),
        ScriptOpcode::POpLoc => panic!("Not implemented"),
        ScriptOpcode::POpNpc => panic!("Not implemented"),
        ScriptOpcode::POpNpcT => panic!("Not implemented"),
        ScriptOpcode::POpObj => panic!("Not implemented"),
        ScriptOpcode::POpPlayer => panic!("Not implemented"),
        ScriptOpcode::POpPlayerT => panic!("Not implemented"),
        ScriptOpcode::PPauseButton => panic!("Not implemented"),
        ScriptOpcode::PStopAction => panic!("Not implemented"),
        ScriptOpcode::PTeleJump => panic!("Not implemented"),
        ScriptOpcode::PTeleport => panic!("Not implemented"),
        ScriptOpcode::PWalk => panic!("Not implemented"),
        ScriptOpcode::PlayerFindAllZone => panic!("Not implemented"),
        ScriptOpcode::PlayerFindNext => panic!("Not implemented"),
        ScriptOpcode::Queue => panic!("Not implemented"),
        ScriptOpcode::Say => panic!("Not implemented"),
        ScriptOpcode::WalkTrigger => panic!("Not implemented"),
        ScriptOpcode::SetTimer => panic!("Not implemented"),
        ScriptOpcode::SoftTimer => panic!("Not implemented"),
        ScriptOpcode::SoundSynth => panic!("Not implemented"),
        ScriptOpcode::SpotAnimPl => panic!("Not implemented"),
        ScriptOpcode::StaffModLevel => panic!("Not implemented"),
        ScriptOpcode::Stat => panic!("Not implemented"),
        ScriptOpcode::StatAdd => panic!("Not implemented"),
        ScriptOpcode::StatBase => panic!("Not implemented"),
        ScriptOpcode::StatHeal => panic!("Not implemented"),
        ScriptOpcode::StatSub => panic!("Not implemented"),
        ScriptOpcode::StrongQueue => panic!("Not implemented"),
        ScriptOpcode::Uid => panic!("Not implemented"),
        ScriptOpcode::WeakQueue => panic!("Not implemented"),
        ScriptOpcode::IfOpenMainOverlay => panic!("Not implemented"),
        ScriptOpcode::AfkEvent => panic!("Not implemented"),
        ScriptOpcode::LowMemory => panic!("Not implemented"),
        ScriptOpcode::SetIdkit => panic!("Not implemented"),
        ScriptOpcode::PClearPendingAction => panic!("Not implemented"),
        ScriptOpcode::GetWalkTrigger => panic!("Not implemented"),
        ScriptOpcode::Busy2 => panic!("Not implemented"),
        ScriptOpcode::FindHero => panic!("Not implemented"),
        ScriptOpcode::BothHeroPoints => panic!("Not implemented"),
        ScriptOpcode::SetGender => panic!("Not implemented"),
        ScriptOpcode::SetSkinColour => panic!("Not implemented"),
        ScriptOpcode::PAnimProtect => panic!("Not implemented"),
        ScriptOpcode::RunEnergy => panic!("Not implemented"),
        ScriptOpcode::Weight => panic!("Not implemented"),
        ScriptOpcode::LastCoord => panic!("Not implemented"),
        // Npc ops (2500-2999)
        ScriptOpcode::NpcAdd => panic!("Not implemented"),
        ScriptOpcode::NpcAnim => panic!("Not implemented"),
        ScriptOpcode::NpcBaseStat => panic!("Not implemented"),
        ScriptOpcode::NpcCategory => panic!("Not implemented"),
        ScriptOpcode::NpcChangeType => panic!("Not implemented"),
        ScriptOpcode::NpcCoord => panic!("Not implemented"),
        ScriptOpcode::NpcDamage => panic!("Not implemented"),
        ScriptOpcode::NpcDel => panic!("Not implemented"),
        ScriptOpcode::NpcDelay => panic!("Not implemented"),
        ScriptOpcode::NpcFaceSquare => panic!("Not implemented"),
        ScriptOpcode::NpcFind => panic!("Not implemented"),
        ScriptOpcode::NpcFindAllAny => panic!("Not implemented"),
        ScriptOpcode::NpcFindAll => panic!("Not implemented"),
        ScriptOpcode::NpcFindExact => panic!("Not implemented"),
        ScriptOpcode::NpcFindHero => panic!("Not implemented"),
        ScriptOpcode::NpcFindAllZone => panic!("Not implemented"),
        ScriptOpcode::NpcFindNext => panic!("Not implemented"),
        ScriptOpcode::NpcFindUid => panic!("Not implemented"),
        ScriptOpcode::NpcGetMode => panic!("Not implemented"),
        ScriptOpcode::NpcHeroPoints => panic!("Not implemented"),
        ScriptOpcode::NpcName => panic!("Not implemented"),
        ScriptOpcode::NpcParam => panic!("Not implemented"),
        ScriptOpcode::NpcQueue => panic!("Not implemented"),
        ScriptOpcode::NpcRange => panic!("Not implemented"),
        ScriptOpcode::NpcSay => panic!("Not implemented"),
        ScriptOpcode::NpcHuntAll => panic!("Not implemented"),
        ScriptOpcode::NpcHuntNext => panic!("Not implemented"),
        ScriptOpcode::NpcSetHunt => panic!("Not implemented"),
        ScriptOpcode::NpcSetHuntMode => panic!("Not implemented"),
        ScriptOpcode::NpcSetMode => panic!("Not implemented"),
        ScriptOpcode::NpcWalkTrigger => panic!("Not implemented"),
        ScriptOpcode::NpcSetTimer => panic!("Not implemented"),
        ScriptOpcode::NpcStat => panic!("Not implemented"),
        ScriptOpcode::NpcStatAdd => panic!("Not implemented"),
        ScriptOpcode::NpcStatHeal => panic!("Not implemented"),
        ScriptOpcode::NpcStatSub => panic!("Not implemented"),
        ScriptOpcode::NpcTele => panic!("Not implemented"),
        ScriptOpcode::NpcType => panic!("Not implemented"),
        ScriptOpcode::NpcUid => panic!("Not implemented"),
        ScriptOpcode::SpotAnimNpc => panic!("Not implemented"),
        ScriptOpcode::NpcWalk => panic!("Not implemented"),
        ScriptOpcode::NpcAttackRange => panic!("Not implemented"),
        ScriptOpcode::NpcHasOp => panic!("Not implemented"),
        ScriptOpcode::NpcArriveDelay => panic!("Not implemented"),
        // Loc ops (3000-3499)
        ScriptOpcode::LocAdd => panic!("Not implemented"),
        ScriptOpcode::LocAngle => panic!("Not implemented"),
        ScriptOpcode::LocAnim => panic!("Not implemented"),
        ScriptOpcode::LocCategory => panic!("Not implemented"),
        ScriptOpcode::LocChange => panic!("Not implemented"),
        ScriptOpcode::LocCoord => panic!("Not implemented"),
        ScriptOpcode::LocDel => panic!("Not implemented"),
        ScriptOpcode::LocFind => panic!("Not implemented"),
        ScriptOpcode::LocFindAllZone => panic!("Not implemented"),
        ScriptOpcode::LocFindNext => panic!("Not implemented"),
        ScriptOpcode::LocName => panic!("Not implemented"),
        ScriptOpcode::LocParam => panic!("Not implemented"),
        ScriptOpcode::LocShape => panic!("Not implemented"),
        ScriptOpcode::LocType => panic!("Not implemented"),
        // Obj ops (3500-4000)
        ScriptOpcode::ObjAdd => panic!("Not implemented"),
        ScriptOpcode::ObjAddAll => panic!("Not implemented"),
        ScriptOpcode::ObjCoord => panic!("Not implemented"),
        ScriptOpcode::ObjCount => panic!("Not implemented"),
        ScriptOpcode::ObjDel => panic!("Not implemented"),
        ScriptOpcode::ObjName => panic!("Not implemented"),
        ScriptOpcode::ObjParam => panic!("Not implemented"),
        ScriptOpcode::ObjTakeItem => panic!("Not implemented"),
        ScriptOpcode::ObjType => panic!("Not implemented"),
        ScriptOpcode::ObjFind => panic!("Not implemented"),
        // Npc config ops (4000-4099)
        ScriptOpcode::NcCategory => panic!("Not implemented"),
        ScriptOpcode::NcDebugname => panic!("Not implemented"),
        ScriptOpcode::NcDesc => panic!("Not implemented"),
        ScriptOpcode::NcName => panic!("Not implemented"),
        ScriptOpcode::NcOp => panic!("Not implemented"),
        ScriptOpcode::NcParam => panic!("Not implemented"),
        // Loc config ops (4100-4199)
        ScriptOpcode::LcCategory => panic!("Not implemented"),
        ScriptOpcode::LcDebugname => panic!("Not implemented"),
        ScriptOpcode::LcDesc => panic!("Not implemented"),
        ScriptOpcode::LcName => panic!("Not implemented"),
        ScriptOpcode::LcOp => panic!("Not implemented"),
        ScriptOpcode::LcParam => panic!("Not implemented"),
        ScriptOpcode::LcWidth => panic!("Not implemented"),
        ScriptOpcode::LcLength => panic!("Not implemented"),
        // Obj config ops (4200-4299)
        ScriptOpcode::OcCategory => panic!("Not implemented"),
        ScriptOpcode::OcCert => panic!("Not implemented"),
        ScriptOpcode::OcCost => panic!("Not implemented"),
        ScriptOpcode::OcDebugname => panic!("Not implemented"),
        ScriptOpcode::OcDesc => panic!("Not implemented"),
        ScriptOpcode::OcIop => panic!("Not implemented"),
        ScriptOpcode::OcMembers => panic!("Not implemented"),
        ScriptOpcode::OcName => panic!("Not implemented"),
        ScriptOpcode::OcOp => panic!("Not implemented"),
        ScriptOpcode::OcParam => panic!("Not implemented"),
        ScriptOpcode::OcStackable => panic!("Not implemented"),
        ScriptOpcode::OcTradeable => panic!("Not implemented"),
        ScriptOpcode::OcUncert => panic!("Not implemented"),
        ScriptOpcode::OcWearPos2 => panic!("Not implemented"),
        ScriptOpcode::OcWearPos3 => panic!("Not implemented"),
        ScriptOpcode::OcWearPos => panic!("Not implemented"),
        ScriptOpcode::OcWeight => panic!("Not implemented"),
        // Inventory ops (4300-4399)
        ScriptOpcode::InvAllStock => panic!("Not implemented"),
        ScriptOpcode::InvSize => panic!("Not implemented"),
        ScriptOpcode::InvStockBase => panic!("Not implemented"),
        ScriptOpcode::InvAdd => panic!("Not implemented"),
        ScriptOpcode::InvChangeSlot => panic!("Not implemented"),
        ScriptOpcode::InvClear => panic!("Not implemented"),
        ScriptOpcode::InvDel => panic!("Not implemented"),
        ScriptOpcode::InvDelSlot => panic!("Not implemented"),
        ScriptOpcode::InvDropItem => panic!("Not implemented"),
        ScriptOpcode::InvDropSlot => panic!("Not implemented"),
        ScriptOpcode::InvFreespace => panic!("Not implemented"),
        ScriptOpcode::InvGetNum => panic!("Not implemented"),
        ScriptOpcode::InvGetObj => panic!("Not implemented"),
        ScriptOpcode::InvItemSpace => panic!("Not implemented"),
        ScriptOpcode::InvItemSpace2 => panic!("Not implemented"),
        ScriptOpcode::InvMoveFromSlot => panic!("Not implemented"),
        ScriptOpcode::InvMoveToSlot => panic!("Not implemented"),
        ScriptOpcode::BothMoveInv => panic!("Not implemented"),
        ScriptOpcode::InvMoveItem => panic!("Not implemented"),
        ScriptOpcode::InvMoveItemCert => panic!("Not implemented"),
        ScriptOpcode::InvMoveItemUncert => panic!("Not implemented"),
        ScriptOpcode::InvSetSlot => panic!("Not implemented"),
        ScriptOpcode::InvTotal => panic!("Not implemented"),
        ScriptOpcode::InvTotalCat => panic!("Not implemented"),
        ScriptOpcode::InvTransmit => panic!("Not implemented"),
        ScriptOpcode::InvOtherTransmit => panic!("Not implemented"),
        ScriptOpcode::InvStopTransmit => panic!("Not implemented"),
        ScriptOpcode::BothDropSlot => panic!("Not implemented"),
        ScriptOpcode::InvDropAll => panic!("Not implemented"),
        ScriptOpcode::InvTotalParam => panic!("Not implemented"),
        ScriptOpcode::InvTotalParamStack => panic!("Not implemented"),
        // Enum ops (4400-4499)
        ScriptOpcode::Enum => panic!("Not implemented"),
        ScriptOpcode::EnumGetOutputCount => panic!("Not implemented"),
        // String ops (4500-4599)
        ScriptOpcode::AppendNum => script_string_ops(code, state),
        ScriptOpcode::Append => script_string_ops(code, state),
        ScriptOpcode::AppendSignNum => script_string_ops(code, state),
        ScriptOpcode::Lowercase => script_string_ops(code, state),
        ScriptOpcode::TextGender => script_string_ops(code, state),
        ScriptOpcode::ToString => script_string_ops(code, state),
        ScriptOpcode::Compare => script_string_ops(code, state),
        ScriptOpcode::TextSwitch => script_string_ops(code, state),
        ScriptOpcode::AppendChar => script_string_ops(code, state),
        ScriptOpcode::StringLength => script_string_ops(code, state),
        ScriptOpcode::SubString => script_string_ops(code, state),
        ScriptOpcode::StringIndexOfChar => script_string_ops(code, state),
        ScriptOpcode::StringIndexOfString => script_string_ops(code, state),
        // Number ops (4600-4699)
        ScriptOpcode::Add => script_math_ops(code, state),
        ScriptOpcode::Sub => script_math_ops(code, state),
        ScriptOpcode::Multiply => script_math_ops(code, state),
        ScriptOpcode::Divide => script_math_ops(code, state),
        ScriptOpcode::Random => script_math_ops(code, state),
        ScriptOpcode::RandomInc => script_math_ops(code, state),
        ScriptOpcode::Interpolate => script_math_ops(code, state),
        ScriptOpcode::AddPercent => script_math_ops(code, state),
        ScriptOpcode::SetBit => script_math_ops(code, state),
        ScriptOpcode::ClearBit => script_math_ops(code, state),
        ScriptOpcode::TestBit => script_math_ops(code, state),
        ScriptOpcode::Modulo => script_math_ops(code, state),
        ScriptOpcode::Pow => script_math_ops(code, state),
        ScriptOpcode::InvPow => script_math_ops(code, state),
        ScriptOpcode::And => script_math_ops(code, state),
        ScriptOpcode::Or => script_math_ops(code, state),
        ScriptOpcode::Min => script_math_ops(code, state),
        ScriptOpcode::Max => script_math_ops(code, state),
        ScriptOpcode::Scale => script_math_ops(code, state),
        ScriptOpcode::BitCount => script_math_ops(code, state),
        ScriptOpcode::ToggleBit => script_math_ops(code, state),
        ScriptOpcode::SetBitRange => script_math_ops(code, state),
        ScriptOpcode::ClearBitRange => script_math_ops(code, state),
        ScriptOpcode::GetBitRange => script_math_ops(code, state),
        ScriptOpcode::SetBitRangeToInt => script_math_ops(code, state),
        ScriptOpcode::SinDeg => script_math_ops(code, state),
        ScriptOpcode::CosDeg => script_math_ops(code, state),
        ScriptOpcode::Atan2Deg => script_math_ops(code, state),
        ScriptOpcode::Abs => script_math_ops(code, state),
        // DB ops (7500-7599)
        ScriptOpcode::DbFindWithCount => panic!("Not implemented"),
        ScriptOpcode::DbFindNext => panic!("Not implemented"),
        ScriptOpcode::DbGetField => panic!("Not implemented"),
        ScriptOpcode::DbGetFieldCount => panic!("Not implemented"),
        ScriptOpcode::DbListAllWithCount => panic!("Not implemented"),
        ScriptOpcode::DbGetRowTable => panic!("Not implemented"),
        ScriptOpcode::DbFindByIndex => panic!("Not implemented"),
        ScriptOpcode::DbFindRefineWithCount => panic!("Not implemented"),
        ScriptOpcode::DbFind => panic!("Not implemented"),
        ScriptOpcode::DbFindRefine => panic!("Not implemented"),
        ScriptOpcode::DbListAll => panic!("Not implemented"),
        // Debug ops (10000-11000)
        ScriptOpcode::Error => panic!("Not implemented"),
        ScriptOpcode::MapProduction => panic!("Not implemented"),
        ScriptOpcode::MapLastClock => panic!("Not implemented"),
        ScriptOpcode::MapLastWorld => panic!("Not implemented"),
        ScriptOpcode::MapLastClientIn => panic!("Not implemented"),
        ScriptOpcode::MapLastNpc => panic!("Not implemented"),
        ScriptOpcode::MapLastPlayer => panic!("Not implemented"),
        ScriptOpcode::MapLastLogout => panic!("Not implemented"),
        ScriptOpcode::MapLastLogin => panic!("Not implemented"),
        ScriptOpcode::MapLastZone => panic!("Not implemented"),
        ScriptOpcode::MapLastClientOut => panic!("Not implemented"),
        ScriptOpcode::MapLastCleanup => panic!("Not implemented"),
        ScriptOpcode::MapLastBandwidthIn => panic!("Not implemented"),
        ScriptOpcode::MapLastBandwidthOut => panic!("Not implemented"),
    }
}
